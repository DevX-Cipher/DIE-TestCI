function detect(){var e,r=PE.getOverlayOffset()
return PE.compareOverlay("'wextract'",16)?(-1!==(r=PE.findSignature(r-3584,3584,"BD04EFFE00000100"))&&(r+=16,sVersion=PE.readWord(r+2)+"."+PE.readWord(r)+"."+PE.readWord(r+6)+"."+PE.readWord(r+4)),bDetected=!0):/sfxcab/.test(PE.getManifest())?((e=PE.section[".rsrc"])&&(r=e.FileOffset+e.VirtualSize,-1!==(r=PE.findSignature(r-1536,1536,"BD04EFFE00000100")))&&(r+=8,sVersion=PE.readWord(r+2)+"."+PE.readWord(r)+"."+PE.readWord(r+6)+"."+PE.readWord(r+4)),bDetected=!0):/wextract/i.test(PE.getVersionStringInfo("InternalName"))?(sVersion=PE.getFileVersion().trim(),bDetected=!0):(PE.compareEP("558bec81ec........535657ff15........a3........ff15........a1........6625....3d")&&PE.compare("'MSCF'00000000",20480)||PE.compareEP("6a..68........e8........66813d............75..a1........81b8................75..")&&PE.compareOverlay("'MSCF'00000000")||PE.compareEP("e9$$$$$$$$558bec81ec........830d..........5356576a..33dbbf........68........895d..881d"))&&(bDetected=!0),0<PE.getNumberOfResources()&&(PE.compare("'MSCF'00000000",PE.getResourceNameOffset("CABINET"))&&(bDetected=!0),PE.compare("'MSCF'00000000",PE.getResourceNameOffset("IDR_CABFILE")))&&(bDetected=!0),result()}init("sfx","Microsoft Cabinet")
