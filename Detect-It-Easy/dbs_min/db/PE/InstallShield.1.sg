function detect(){if(PE.compareEP("64a1........558bec6a..68........68........50648925........83ec..5356578965..ff15")){if(PE.isOverlayPresent())nOffset=PE.readByte(PE.getOverlayOffset())+PE.getOverlayOffset()+12,PE.compare("135d658c",nOffset)?(sVersion="3.X",bDetected=!0):PE.compare("'PK'0304",nOffset)&&(sVersion="3.X",sOptions="zip",bDetected=!0)
else for(var e=0;e<PE.resource.length;e++)if(3e3==PE.resource[e].Type&&PE.compare("'SZDD'",PE.resource[e].Offset)){sVersion="2.X",bDetected=!0
break}PE.isSectionNamePresent("_cabinet")&&(bDetected=!0)}else PE.compareEP("558bec6a..68........68........64a1........50648925........83ec..5356578965..ff15")?-1!==PE.findSignature(PE.getOverlayOffset(),256,"'InstallShield Native Installer'")?(sName+=" Java Edition",bDetected=!0):-1!==PE.findSignature(PE.getOverlayOffset(),256,"'setup.class'")&&(sName+=" Java Edition",sVersion="3.X",bDetected=!0):PE.compareEP("558BEC83EC4456FF15........8BF085F675086AFFFF15........8A06578B3D")?bDetected=!0:PE.compareEP("558bec6a..68........68........64a1........50648925........83ec..5356578965..ff15........33d2")?-1!==PE.findSignature(PE.getOverlayOffset(),Math.min(8192,PE.getOverlaySize()),"'ISc('")&&(sVersion="19.X",bDetected=!0):PE.compareEP("e8$$$$$$$$8bff558bec83ec..a1........8365....8365....5357bf........bb........3bc774..85c374..f7")?-1!==PE.findSignature(PE.getOverlayOffset(),Math.min(8192,PE.getOverlaySize()),"'ISSetupStream'")&&(sVersion="18.X",bDetected=!0):PE.compareEP("e8$$$$$$$$558bec83ec..a1........8365....8365....5657bf........be........3bc7")?-1!==PE.findSignature(PE.getOverlayOffset(),Math.min(65536,PE.getOverlaySize()),"'ISc('")&&(sVersion="25.X",bDetected=!0):PE.compareEP("e8$$$$$$$$8b0d........5657bf........be........3bcf74..85ce75..e8........8bc8")?PE.compareOverlay("'ISSetupStream'")&&(sVersion="29.X",bDetected=!0):PE.compareEP("e8$$$$$$$$558bec83ec..a1........8365....8365....5657bf........be........3bc774..85c674..f7")&&PE.compareOverlay("'ISSetupStream'")&&(sVersion="19.X",bDetected=!0)
return"InstallShield"!=PE.getVersionStringInfo("ProductName").substr(0,13)&&"InstallShield Software Corporation"!=PE.getVersionStringInfo("CompanyName")||(sVersion=PE.getVersionStringInfo("FileVersion").replace(/, /g,".").trim(),bDetected=!0),bDetected||/InstallShield/.test(PE.getManifest())&&(bDetected=!0),result()}init("installer","InstallShield")
