function detect(){var e
PE.isNet()||(bDetected=!0,PE.is64()&&(bDetected=!1),validateNativeImports(isPositive=!0,references=[[e="kernel32.dll","GetProcAddress"],[e,"ExitProcess"],[e,"GetModuleFileNameA"],[e,"GetComputerNameA"],[e,"VirtualAllocExNuma"],["shlwapi.dll","PathFindFileNameA"]])&&(bDetected=!1),3==PE.getNumberOfSections()&&PE.compareEP("E8??????006A00FF15A4????00C3")&&PE.isSectionNamePresent(".rsrc")&&PE.isSectionNamePresent(".idata")&&PE.isSectionNamePresent(".text")&&-1!=PE.findString(PE.section[".rsrc"].FileOffset,PE.section[".rsrc"].FileSize,"</assembly>")&&PE.getSectionVirtualSize(1)+PE.getSectionVirtualSize(2)<PE.getSectionVirtualSize(0)&&PE.isSignatureInSectionPresent(1,"00'Shlwapi.dll'00")||(bDetected=!1),sOptions+="RunPE"),PE.isNet()&&(bDetected=!0,validateReferences(isPositive=!0,references=["kernel32.dll","LoadLibraryA","GetProcAddress","System.Runtime.InteropServices","System.Runtime.CompilerServices","System.IO","System.Reflection","System.Resources","System.Collections.Generic","System.Core","System.Linq","IEnumerable`1","<>c__DisplayClass1","Func`2"],section=0)&&(bDetected=!1),PE.isNetObjectPresent("BeginInvoke")||PE.isNetObjectPresent("EndInvoke"))&&(sOptions+="Invoke"),sVersion="v4.0"}function validateReferences(e,t,i){for(var r=0;r<t.length;r++){var n="00'"+t[r]+"'00"
if(1==e){if(!PE.isSignatureInSectionPresent(i,n))return!0}else if(PE.isSignatureInSectionPresent(i,n))return!0}return!1}function validateNativeImports(e,t){for(var i=0;i<t.length;i++){var r=t[i],n=r[0],r=r[1]
if(1==e){if(!PE.isLibraryFunctionPresent(n,r))return!0}else if(PE.isLibraryFunctionPresent(n,r))return!0}return!1}init("cryptor","PEUnion")
