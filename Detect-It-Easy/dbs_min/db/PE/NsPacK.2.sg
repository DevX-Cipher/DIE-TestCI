function getNSPackVersion(){0<PE.section[0].FileSize&&PE.section[0].FileOffset<512?sVersion="2.X":0==PE.section[0].FileSize&&512<=PE.section[0].FileOffset&&(sVersion="3.X")}function detect(){var e=PE.getNumberOfImportThunks(0)
return 6!=e||PE.getSizeOfCode()||"LoadLibraryA"==PE.getImportFunctionName(0,0)&&"GetProcAddress"==PE.getImportFunctionName(0,1)&&"VirtualProtect"==PE.getImportFunctionName(0,2)&&"VirtualAlloc"==PE.getImportFunctionName(0,3)&&"VirtualFree"==PE.getImportFunctionName(0,4)&&"ExitProcess"==PE.getImportFunctionName(0,5)&&(getNSPackVersion(),bDetected=!0),bDetected||(PE.isLibraryPresent("mscoree.dll")&&"KERNEL32.dll"==PE.getImportLibraryName(0)&&"GetSystemInfo"==PE.getImportFunctionName(0,e-1)?(getNSPackVersion(),sOptions=".NET",bDetected=!0):PE.isImportPositionHashPresent(0,2249268809)&&PE.isNetObjectPresent("nsnet")?(sVersion="3.X",bDetected=!0):PE.compareEP("9c60e8..........83....8d8d........8039..0f..........c601..8bc5")?(sVersion="3.7",bDetected=!0):PE.compareEP("9c60e8........5d83ed..8d9d........8a033c..74..8d9d........8a03")?(sVersion="3.1",bDetected=!0):PE.compareEP("9c60e8........5d83ed..8d85........8338..0f..........c700........8bd5")?(sVersion="3.6",bDetected=!0):PE.compareEP("9c60e8........5d83ed..8d85........8038..0f..........c600..8bd5")?(sVersion="3.5",bDetected=!0):PE.compareEP("9c60e8........5db8........2be88db5........8a063c..74..8bf5")?(sVersion="2.9",bDetected=!0):PE.compareEP("e9$$$$$$$$e9$$$$$$$$e9$$$$$$$$9c60e8........5db8........2be88db5........8b06")?(sVersion="2.3-2.9",bDetected=!0):PE.compareEP("9c60e8........5d83ed..8d85........8038..74..8d85........8038..0f84........c600..8bd5")&&(sVersion="3.3",bDetected=!0)),result()}init("packer","NsPack")
