function detect(){for(var e="",t=0,i=0,r=0,s=0,n=0,f=0,B=0,o=PE.OffsetToVA(PE.getEntryPointOffset()),P=0;P<1e3;)P++,"CLC"==(e=-1!=(e=PE.getDisasmString(o)).indexOf(" ")?e.slice(0,e.indexOf(" ")):e)&&t++,"STC"==e&&i++,"MOVZX"==e&&r++,"SUB"==e&&s++,"IMUL"==e&&n++,"BT"!=e&&"BTR"!=e&&"BTS"!=e&&"BTC"!=e||f++,"BSF"!=e&&"BSR"!=e&&"BSWAP"!=e||B++,o=PE.getDisasmNextAddress(o)
return 0<t&&0<i&&0!=r&&(n<s||0==s&&0==n)&&0==f&&0==B&&(bDetected=!0),result()}init("protector","PELock")
